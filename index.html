<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Planning Poker</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        button { margin: 5px; padding: 10px; }
        #results { margin-top: 20px; }
    </style>
</head>
<body>
    <h1>Simple Planning Poker</h1>
    <div id="roomControls">
        <input type="text" id="roomInput" placeholder="Enter room name">
        <button onclick="createOrJoinRoom()">Create/Join Room</button>
    </div>
    <div id="votingArea" style="display:none;">
        <h2>Room: <span id="roomName"></span></h2>
        <div id="cards"></div>
        <button onclick="revealVotes()">Reveal Votes</button>
        <button onclick="resetVotes()">Reset</button>
    </div>
    <div id="results"></div>

    <script>
        let currentRoom = '';
        const cards = ['1', '2', '3', '5', '8', '13', '21', '?'];

        function createOrJoinRoom() {
            currentRoom = document.getElementById('roomInput').value;
            if (currentRoom) {
                document.getElementById('roomName').textContent = currentRoom;
                document.getElementById('roomControls').style.display = 'none';
                document.getElementById('votingArea').style.display = 'block';
                renderCards();
            }
        }

        function renderCards() {
            const cardsDiv = document.getElementById('cards');
            cardsDiv.innerHTML = '';
            cards.forEach(card => {
                const button = document.createElement('button');
                button.textContent = card;
                button.onclick = () => vote(card);
                cardsDiv.appendChild(button);
            });
        }

        function vote(value) {
            localStorage.setItem(`${currentRoom}_${Date.now()}`, value);
        }

        function revealVotes() {
            const results = document.getElementById('results');
            results.innerHTML = '<h3>Votes:</h3>';
            const votes = getVotes();
            Object.keys(votes).forEach(timestamp => {
                results.innerHTML += `<p>Vote at ${new Date(parseInt(timestamp)).toLocaleTimeString()}: ${votes[timestamp]}</p>`;
            });
        }

        function resetVotes() {
            Object.keys(localStorage).forEach(key => {
                if (key.startsWith(currentRoom)) {
                    localStorage.removeItem(key);
                }
            });
            document.getElementById('results').innerHTML = '';
        }

        function getVotes() {
            const votes = {};
            Object.keys(localStorage).forEach(key => {
                if (key.startsWith(currentRoom)) {
                    const timestamp = key.split('_')[1];
                    votes[timestamp] = localStorage.getItem(key);
                }
            });
            return votes;
        }
    </script>
</body>
</html>
